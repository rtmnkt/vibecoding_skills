# プロジェクトリーダースキル 新規作成指示書

## 概要

作業者（タスクスキル使用agent）を並列化し、長時間ユーザーへ非対話でClaude Codeを稼働させるためのスキルを新規作成する。

## 目的

1. **作業者の並列化**: 複数のタスクを同時に進行させる
2. **長時間非対話稼働**: ユーザーが離席中も作業を継続
3. **要件定義からの実装管理**: ユーザー指示を要件として追加、実装状況を報告

## 性質

- **任意**: なくても問題ない（単一タスクの逐次実行は可能）
- **上位レイヤー**: タスクスキル、プロジェクト駆動スキルを使う側

## 依存関係

```
ユーザー指示
    ↓
プロジェクトリーダースキル
    ├→ タスクスキル（作業者として）
    └→ プロジェクト駆動スキル（開発ルールとして）
```

## 想定されるフロー

```
1. ユーザー: 「機能X, Y, Zを追加して」
2. リーダー: 要件定義に追加、タスクに分解
3. リーダー: タスクA（機能X）を作業者agentに割り当て
4. リーダー: タスクB（機能Y）を別の作業者agentに割り当て（並列）
5. 作業者: 各タスクを独立して実行
6. リーダー: 完了を監視、結果を集約
7. リーダー: ユーザーに実装状況を報告
```

## 設計から検討すべき項目

### 1. 並列化の仕組み

検討ポイント:
- 何を並列化するか（タスク? サブタスク?）
- 並列数の制限
- リソース競合の管理（git worktreeで分離?）
- 依存関係のあるタスクの順序制御

### 2. 長時間稼働の仕組み

検討ポイント:
- ユーザー離席中の動作継続方法
- 異常発生時の対応（停止? 通知? 自動リトライ?）
- 進捗の永続化（CC再起動後も状態復元）

### 3. ユーザーへの報告

検討ポイント:
- 報告タイミング（完了時? 定期? 異常時?）
- 報告形式（ファイル? 通知?）
- 詳細度（サマリー? 全ログ?）

### 4. 作業者への指示出し

検討ポイント:
- タスク定義の渡し方
- 作業者の起動方法（async-shell経由?）
- 作業者との通信（ファイル? tmux send-keys?）

### 5. オーケストレーションパターン

検討ポイント:
- Bashスクリプトで実装（軽量）
- 中間Claude層（柔軟だがコンテキスト消費）
- Pythonデーモン（複雑な制御可能）
- MCPサーバー（Claude連携最適化）

前回の会話で「段階的アプローチ」が提案されていた:
1. まずBash + ファイルベース
2. 必要に応じて中間Claude層
3. 本格運用ならMCPサーバー化

## async-shellとの関係

リーダースキルは直接async-shellを使う可能性がある:
- 作業者agentの起動（split）
- 状態監視（capture）
- 結果収集

または、タスクスキル経由で間接的に使う。

## 制約

- 具体的なメカニズムは前回の会話で未議論
- 設計から検討し、提案すること
- 複雑になりすぎないように段階的に

## 注意事項

- タスク間の依存関係管理が必要な場合、その複雑さを考慮
- ユーザーが「1つずつ」を好む場合、並列化は不要
- 最初はシンプルに、必要に応じて拡張

## 参考

- CI/CDのオーケストレーション
- タスクキュー（Celery等）
- GitHub Actions のワークフロー
